using System.Text;\npublic class Solution {\n    public string Convert(string s, int numRows) {\n        if (numRows == 1 || numRows >= s.Length) {\n            return s;\n        }\n        StringBuilder[] rows = new StringBuilder[numRows];\n        for (int i = 0; i < numRows; i++) {\n            rows[i] = new StringBuilder();\n        }\n        int currentRow = 0;\n        bool goingDown = false;\n        foreach (char c in s) {\n            rows[currentRow].Append(c);\n            if (currentRow == 0 || currentRow == numRows - 1) {\n                goingDown = !goingDown;\n            }\n            currentRow += goingDown ? 1 : -1;\n        }\n        StringBuilder result = new StringBuilder();\n        foreach (var row in rows) {\n            result.Append(row);\n        }\n        return result.ToString();\n    }\n}